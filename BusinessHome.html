<html>
    <head>
        
        
        <!--<link rel="stylesheet" type="text/css" href="MyMaynooth.css">-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
   
  <link rel=stylesheet type="text/css" href=MM.css>
<!--      <script src=MyMaynooth.js></script>-->
      <script src="https://www.gstatic.com/firebasejs/4.6.0/firebase.js"></script>
<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <style type="text/css"> #contacts p, #contacts p.lead{ margin: 0; } </style>
    <!-- update the version number as needed-->
    <script defer src="/__/firebase/4.6.0/firebase-app.js"></script>
    <!-- include only the Firebase features as you need-->
    <script defer src="/__/firebase/4.6.0/firebase-auth.js"></script>
    <script defer src="/__/firebase/4.6.0/firebase-database.js"></script>
    <script defer src="/__/firebase/4.6.0/firebase-messaging.js"></script>
    <script defer src="/__/firebase/4.6.0/firebase-storage.js"></script>
      
    <!-- initialize the SDK after all desired features are loaded-->
    <script defer src="/__/firebase/init.js"></script>
     
        <script>
    
        $(function() {
  const config = {
    apiKey: "AIzaSyCFW7ylQ2im6knlgQVAXjxDjmncECjAWC8",
    authDomain: "mymaynoothproject-231017.firebaseapp.com",
    databaseURL: "https://mymaynoothproject-231017.firebaseio.com",
    projectId: "mymaynoothproject-231017",
    storageBucket: "mymaynoothproject-231017.appspot.com",
    messagingSenderId: "508311719577"
  };
  //firebase.initializeApp(config);
            var person;
            person = prompt("Please Confirm Your ID:", "");
  document.getElementById("newEvent").addEventListener("click",r =>{
              
               if(person==null||person==" ")
        {
           console.log("null");
        }
    else{
       $("#addNewDiscount").css("display","none");
        
        $("#addNewEvent").css("display","block");
       }});
 
document.getElementById("newDis").addEventListener("click",r =>{
     
    console.log(person);
    if(person==null||person==" ")
        {
            console.log("null");
        }
    else{
       $("#addNewDiscount").css("display","block");
        
        $("#addNewEvent").css("display","none");
       }});
            
            $(".js-form").on("submit", event => {
    event.preventDefault();
      //var admin=require("firebase-admin");
      var db=firebase.database();
      var ref=db.ref("Discounts");
      const name= $("#js-name").val();
    const location = $("#js-location").val();
    const provider = $("#js-provider").val();
    const description = $("#js-desc").val();
      var yourSelect=document.getElementById("genreSelect");
    const genre=yourSelect.options[yourSelect.selectedIndex].value;
      var events=ref.child(genre);
    
           events=ref.child(genre).child(name); events.set({name,location,provider,description,genre,},function(error){
                if(error)
                    console.log("No Data Saved");
                else{
                    console.log("New Offer Created");
                
                      var db=firebase.database();
            var ref=db.ref("Business").child(person);  
                var events=ref.child("Discounts").child(name);
                events.set({name,location,provider,description,genre,},function(error){
                if(error)
                    console.log("No Data Saved");
                else{
                    console.log("New Offer Created");
                 
                  
                  
                }
                });
                    
                    $( '.js-form' ).each(function(){
    this.reset();
});
                  $( '#js-desc' ).val("");
                  
                }
            })
            });
           
            $(".js-form2").on("submit", event => {
    event.preventDefault();
      //var admin=require("firebase-admin");
      var db=firebase.database();
      var ref=db.ref("Events");
      const name2= $("#js-name2").val();
    const location2 = $("#js-location2").val();
      
    const provider2 = $("#js-provider2").val();
    const description2 = $("#js-desc2").val();
      var yourSelect2=document.getElementById("genreSelect2");
    const genre2=yourSelect2.options[yourSelect2.selectedIndex].value;
                console.log(genre2);
      var events=ref.child(genre2);
    
           events=ref.child(genre2).child(name2); 
                events.set({name2,location2,provider2,description2,genre2,},function(error){
                if(error)
                    console.log(error);
                else{
                    console.log("New Event Created");
                    var db=firebase.database();
            var ref=db.ref("Business").child(person);  
                var events=ref.child("Events").child(name2);
                events.set({name2,location2,provider2,description2,genre2,},function(error){
                if(error)
                    console.log("No Data Saved");
                else{
                    console.log("New Offer Created");
                 
                  
                  
                }
                });
                }
               
            })
            });
        
      //var admin=require("firebase-admin");
//      var db=firebase.database();
//      var ref=db.ref("Business Names");
//      const name= $("#js-nameB").val();
//    const email = $("#js-emailB").val();
//    const id = $("#js-idB").val();
//    const password = $("#js-passwordB").val();
//    const message = "New Business Registered";
//      var yourSelect=document.getElementById("companySelect");
//    const industry=yourSelect.options[yourSelect.selectedIndex].value;
//      
//    var dt = new Date();
//    var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
//    console.log(email, password,industry);
//    firebase.auth().createUserWithEmailAndPassword(email, password)
//      .then(user => {
//       firebase.auth().signInWithEmailAndPassword(email, password)
//        .then(user =>{
//           var business=ref.child(industry).child(name); business.set({name,email,id,message,industry,time,},function(error){
//                if(error)
//                    console.log("No Data Saved");
//                else
//                    window.location.replace("BusinessHome.html");
//            })
//            })
//        .catch(error=>{
//              console.log(error);
//               });
//       })
//      .catch(error => {
//        console.log("Create Error");
//      });
       
     
      
//             var db=firebase.database();
//      var ref=db.ref("Business").child(person);  
//                var events=ref.child("Discounts");
//                events.set({name,location,provider,description,genre,},function(error){
//                if(error)
//                    console.log("No Data Saved");
//                else{
//                    console.log("New Offer Created");
//                 
//                  
//                  
//                }
//            })
            //});
           
//              $(".js-form2").on("submit", event => {
//    event.preventDefault();
//      //var admin=require("firebase-admin");
//      var db=firebase.database();
//      var ref=db.ref("Events");
//      const name= $("#js-name").val();
//    const location = $("#js-location").val();
//      
//    const provider = $("#js-provider").val();
//    const description = $("#js-desc").val();
//      var yourSelect=document.getElementById("genreSelect");
//    const genre=yourSelect.options[yourSelect.selectedIndex].value;
//      var events=ref.child(genre);
//    
//           events=ref.child(genre).child(name); events.set({name,location,provider,description,genre,},function(error){
//                if(error)
//                    console.log(error);
//                else
//                    console.log("New Event Created");
//            })
//            ref=db.ref("Business").child(person);
//            events=ref.child("Events");
//        events.set({name,location,provider,description,genre,},function(error){
//                if(error)
//                    console.log(error);
//                else
//                    console.log("New Event Created");
//            })
//                  
//            });
            
      var modal = document.getElementById('myModal');
      var para = document.getElementById('modalInfo');
      
// Get the button that opens the modal
var btn=document.getElementById("newDis");
var btn2=document.getElementById("newEvent");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];
//document.getElementsByClassName("tableRow").style.background="yellow";
      
// When the user clicks the button, open the modal 
btn.onclick = function() {
    document.getElementById('newD').style.display = "block";
    document.getElementById('newE').style.display = "none";
}
btn2.onclick = function() {
    document.getElementById('newE').style.display = "block";
    document.getElementById('newD').style.display = "none";
}
    
//    var btn=document.getElementById("js-submit");
//            var form=document.getElementById("form1");
//            btn.onclick=function(e){
//                e.preventDefault();
//                form.submit();
//                console.log("test");
//                
//            }
//    

firebase.database().ref('Business/'+person).child("Discounts").once("value").then(function(snap) {
	                snap.forEach(function(childSnap){
                        document.getElementById('pid').innerHTML+="<center><button class=GEvents>"+childSnap.val().name+"</button></center>";
	                });
	              
	            }); 


//btn2.onclick=function()
//{
//    modal.style.display = "block";
//    para.innerHTML="<form class='js-form' id='form2'><label for='js-form2'>New Event</label><div class='form-group'><input placeholder='Event Name' type='text' id='js-name' class='form-control'></div><div class='form-group'><input placeholder='Event Location' type='text' id='js-location' class='form-control'></div><div class='form-group'><input placeholder='Event Provider/Business Name' type='text' id='js-provider' class='form-control'></div><div class='form-group'><select class='form-control' id='genreSelect'><option value='Genre'>Genre</option><option value='Food'>Food</option><option value='Entertainment'>Entertainment</option><option value='Academic'>Academic</option></select></div><div class='form-group'><textarea placeholder='Event Description(incl.Valid/Expiry Date)' id='js-desc' class='form-control' form=form-group></textarea></div><div class='incorrect'><p>Incorrect Details</p></div><button id='js-submit' class='btn btn-primary'>Submit Event</button></form>"
//}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
//window.onclick = function(event) {
//    if (event.target == modal) {
//        modal.style.display = "none";
//    }
//}
function example4(){
    modal.style.display = "block";
}
$("#log").on("click", event => {
    event.preventDefault();
    firebase.auth().signOut().then(function(){
   window.location.replace("Login.html");
    })
})
//      var rootRef = firebase.database().ref('Business').child(id);
//
//rootRef.on("child_added", snap => {
//	var description = snap.child("description").val();
//	var genre = snap.child("genre").val();
//	var location = snap.child("location").val();
//	var name = snap.child("name").val();
//	var provider = snap.child("provider").val();
//
//	var newRow=$("#entBody").append("<button class='Events' id='"+name+"'>"+name+"</button>");
//    newRow.className="tableRow";
//    //console.log(description);
//   var btn=document.getElementsByClassName("Events");
//       
//    for(i=0;i<btn.length;i++)
//        {
//            btn[i].onclick= function (){
//                modal.style.display="block";
//            }
//        }
//    $("button").click(function(){
//        var newName=$(this).html();
//        var modRef=firebase.database().ref('Events').child('Entertainment').child(newName);
//        modRef.on("value", snap => {
//	    var descriptionmod = snap.child("description").val();
//        var genremod = snap.child("genre").val();
//	    var locationmod = snap.child("location").val();
//	    //var namemod = snap.child("name").val();
//	    var providermod = snap.child("provider").val();
//        para.innerHTML="Information:"+descriptionmod;
//        footer.innerHTML=providermod+" "+locationmod;
//        header.innerHTML=newName;    
//        })
//        });
//    
//});
            
            var rootRef=firebase.database().ref().child("Events/Entertainment"); //use to retrieve entertainment events
 var rootRef2=firebase.database().ref().child("Events/Food"); //use to retrieve food offers
 
 rootRef.on("child_added", snap => { //fill the empty event table 
  
  var provider=snap.child("provider".val()); 
  var name=snap.child("name".val());
  var description=snap.child("description".val());
  var ARTS=snap.child("ARTS".val());
  var CSSE=snap.child("CSSE".val());
  var OTHER=snap.child("OTHER".val());
  
   $("#table_body").append("<tr><td>"+provider+"</td></td>"+name+
                      "</td><td>"+description+"</td><td>"+ARTS+"</td><td>"+CSSE+"</td><td>"+OTHER+"</td></tr>");

  });


 rootRef2.on("child_added", snap => {  //fill food table
  
  var provider=snap.child("provider".val());
  var name=snap.child("name".val());
  var description=snap.child("description".val());


  $("#table_body").append("<tr><td>"+provider+"</td></td>"+name+
                      "</td><td>"+description+"</td></tr>");

  });
$("#busComp").click(function (){
    document.getElementById("comp").style.display="block";
    document.getElementById("add").style.display="none";
})
            $("#busAdd").click(function (){
    document.getElementById("comp").style.display="none";
    document.getElementById("add").style.display="block";
})

       });</script>
        
        
        
        
        
        <style>
            h1 {
  text-align: center;
}
body {
  background-color: black;
  color: gold;
}
.container {
  padding: 1rem;
}
.incorrect {
  color: red;
  display: none;
}
#link-login {
  padding: 10px;
  color: gold;
}
#PlaceholderDegree {
  color: green;
}
            #add{
                display: block;
            }
            #perf{display: none;}
            #comp{display: none;}
            #addNewDiscount{display: none;}
            #addNewEvent{display: none;}
            #newD{display:none;}
            #newE{display:none;}
            #pid{color:white;}
</style>
    </head>
    <body id=loginBody>
        <h1 class=lmmh1>MyMaynooth</h1>
        <div id=sort><button class="sort" id=busAdd>Add/Update Offer</button>
<!--        <button class="sort" id=busPerf>Check Performance</button>-->
        <button class="sort" id=busComp>View Competitors Offers</button></div>
        
        <div id=add>
<button id="newDis" class="btn btn-primary">Add New Discount</button>
<button id="newEvent" class="btn btn-primary">Add New Event</button>
            <div id=newD>
             <form class='js-form' id=form1>
                 <label for="js-form">New Discount</label>
                 <div class='form-group'>
                     <input placeholder='Offer Name' type='text' id='js-name' class='form-control'>
                 </div>
                 <div class='form-group'> 
                     <input placeholder='Offer Location' type='text' id='js-location' class='form-control'>
                 </div>
                 <div class='form-group'>
                     <input placeholder='Offer Provider/Business Name' type='text' id='js-provider' class='form-control'>
                 </div>
                 <div class='form-group'>
                     <select class='form-control' id='genreSelect'>
                         <option value='Genre'>Genre</option>
                         <option value='Food'>Food</option>
                         <option value='Entertainment'>Entertainment</option>
                         <option value='Academic'>Academic</option>
                     </select>
                 </div>
                 <div class='form-group'>
                     <textarea placeholder="Offer Description(incl.Valid/Expiry Date,How-to-Redeem)" id='js-desc' class='form-control' form=form-group>
                     </textarea>
                 </div>
                 <div class='incorrect'>
                     <p>Incorrect Details</p>
                 </div>
                 <div class='form-group'>
                     <button id='js-submit' class='btn btn-primary'>Submit Offer</button>
                 </div>
            </form>
            </div>
            <div id=newE>
                 <form class="js-form2">
          <label for="js-form2">New Event</label>
            <div class="form-group">

            <input placeholder="Event Name" type="text" id="js-name2" class="form-control">
          </div>
          <div class="form-group">

            <input placeholder="Event Location" type="text" id="js-location2" class="form-control">
          </div>
          <div class="form-group">

            <input placeholder="Event Provider/Business Name" type="text" id="js-provider2" class="form-control">
          </div>
          <div class="form-group">
            <select class="form-control" id="genreSelect2">
             <option value="Genre">Genre</option>
             <option value="Food">Food</option>
             <option value="Entertainment">Entertainment</option>
             <option value="Academic">Academic</option>
            </select>
          </div>
          <div class="form-group">

            <textarea placeholder="Event Description(incl.Valid/Expiry Date)" id="js-desc2" class="form-control" form=form-group></textarea>
          </div>
          <div class="incorrect">
            <p>Incorrect Details</p>
          </div>
          <button id="js-submit2" class="btn btn-primary">Submit Event</button>
            </form>
            </div>
            <h1>Current Offers/Events</h1>
           <p id=pid></p>
            

        </div>
        
        <div id=comp>
            <h3 style="color:white">COMING SOON...</h3>
          <!--<div class="mainDiv" align="left">    <!--Create empty table for events, with headers
<h1>Other Entertainment Offers</h1>
<table>
 <thead>
 <tr>
 <td>provider</td>
 <td>name</td>
 <td>description</td>
 <td>ARTS</td>
 <td>CSSE</td>
 <td>OTHER</td>
 </tr>
</thead>
<tbody id="table_body">

</tbody>
</table>
</div>
 
<div class="mainDiv2" align="left">  <!--Create empty table for food offers
<h1>Other Food Offers</h1>
<table>
 <thead>
 <tr>
 <td>provider</td>
 <td>description</td>
 <td>name</td>
 </tr>
</thead>
<tbody id="table_body2">

</tbody>
</table>
</div>
-->








        </div>
        
     
   <div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <div class="modal-header">
      <span class="close">&times;</span>
      <h2 id=modHead>New Offer/Event</h2>
    </div>
    <div class="modal-body">
        <p id=modalInfo></p>
        
    </div>
    <div class="modal-footer">
      <h3 id=modFoot></h3>
    </div>
  </div>

</div>
    <div class=entCon>
    
  
        <div id=entBody></div>
    </div>
    <div class=foodCon>
 
        
      
    
    </div>
     <div class="signout" id=log><a class="signout" id="js-Sign">Log Out</a></div>
    </body>
</html>